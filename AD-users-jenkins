Skip to content
Chat history



You said:
power shell ×ª×¡×¨×™×˜
×‘×•×“×§ ×¢× ××©×ª××© AD ×§×™×™× ×‘××™×“×” ×•×§×™×™× ×•×—×‘×¨ ×‘×§×‘×•×¦×” X ×‘××™×“×” ×•×œ× ×ª×•×¡×™×£ ×œ×§×‘×•×¦×” X
×•×‘× ×•×¡×£ ×ª×¢×“×›×Ÿ ×¡×™×¡××” 1-6
ChatGPT said:
×œ×”×œ×Ÿ ×ª×¡×¨×™×˜ PowerShell ××œ× ×•×‘×¨×•×¨ ×©×¢×•×©×” ×‘×“×™×•×§ ××” ×©×‘×™×§×©×ª:

××” ×”×¡×§×¨×™×¤×˜ ×¢×•×©×”:

×‘×•×“×§ ×× ××©×ª××© AD ×§×™×™×

×× ×§×™×™× â€“ ×‘×•×“×§ ×”×× ×”×•× ×—×‘×¨ ×‘×§×‘×•×¦×” X

×× ×œ× ×—×‘×¨ â€“ ××•×¡×™×£ ××•×ª×• ×œ×§×‘×•×¦×”

××¢×“×›×Ÿ ×¡×™×¡××” (××•×¨×š 6 ×ª×•×•×™× â€“ ×”×¢×¨×” ×—×©×•×‘×” ×œ××˜×”)

×“×¨×™×©×•×ª ××§×“×™××•×ª
×œ×”×¨×™×¥ ×¢×œ ××—×©×‘ ×¢× RSAT / ActiveDirectory module

×”×¨×©××•×ª ××ª××™××•×ª ×‘-AD

×¡×§×¨×™×¤×˜ PowerShell
Import-Module ActiveDirectory

# ===== ××©×ª× ×™× =====
$UserSam  = "username1"        # samAccountName ×©×œ ×”××©×ª××©
$GroupName = "GroupX"          # ×©× ×”×§×‘×•×¦×”
$NewPassword = "Abc123"        # ×¡×™×¡××” ×‘××•×¨×š 6 ×ª×•×•×™×

# ===== ×‘×“×™×§×ª ××©×ª××© =====
$user = Get-ADUser -Filter "SamAccountName -eq '$UserSam'" -ErrorAction SilentlyContinue

if (-not $user) {
    Write-Host "âŒ ×”××©×ª××© ×œ× ×§×™×™× ×‘-AD"
    exit
}

Write-Host "âœ… ×”××©×ª××© ×§×™×™×"

# ===== ×‘×“×™×§×ª ×—×‘×¨×•×ª ×‘×§×‘×•×¦×” =====
$group = Get-ADGroup $GroupName
$isMember = Get-ADGroupMember $group | Where-Object { $_.DistinguishedName -eq $user.DistinguishedName }

if (-not $isMember) {
    Add-ADGroupMember -Identity $GroupName -Members $user
    Write-Host "â• ×”××©×ª××© × ×•×¡×£ ×œ×§×‘×•×¦×” $GroupName"
}
else {
    Write-Host "â„¹ï¸ ×”××©×ª××© ×›×‘×¨ ×—×‘×¨ ×‘×§×‘×•×¦×”"
}

# ===== ×¢×“×›×•×Ÿ ×¡×™×¡××” =====
$SecurePass = ConvertTo-SecureString $NewPassword -AsPlainText -Force

Set-ADAccountPassword `
    -Identity $user `
    -NewPassword $SecurePass `
    -Reset

Unlock-ADAccount -Identity $user

Write-Host "ğŸ”‘ ×”×¡×™×¡××” ×¢×•×“×›× ×” ×‘×”×¦×œ×—×”"
âš ï¸ ×”×¢×¨×” ×—×©×•×‘×” ×¢×œ ×¡×™×¡××” ×‘××•×¨×š 6
×‘×¨×•×‘ ×”×“×•××™×™× ×™×:

××“×™× ×™×•×ª ×”×¡×™×¡×××•×ª ×œ× ×××¤×©×¨×ª ×¤×—×•×ª ×-8 ×ª×•×•×™×

×× ×ª×¨×™×¥ ×•×ª×§×‘×œ ×©×’×™××” â†’ ×–×• ×”×¡×™×‘×”

×× ×ª×¨×¦×”:

××•×›×œ ×œ×”×ª××™× ×œ×¡×™×¡××” ××§×¨××™×ª ×—×•×§×™×ª ×œ×¤×™ ×”-Password Policy

××• ×œ×™×™×¦×¨ ×¡×™×¡××” ×‘××•×¨×š ××©×ª× ×” (8â€“12)

××• ×œ×§×‘×œ ×¨×©×™××ª ××©×ª××©×™× ××§×•×‘×¥ JSON / CSV (×›××• ×©×›×‘×¨ ×¢×‘×“×ª ×‘×¢×‘×¨)

×¨×§ ×ª×’×™×“ ğŸ‘

You said:
×˜×•×‘
×‘×•×§×¨ ×”××©×ª××© ×œ×  ×§×™×™× ×ª×§×™×™× ××•×ª×• ×•×ª×•×¡×£ ×œ×§×‘×•×¦×” X +×¢×“×›×•×Ÿ ×¡×™×¡××”   12346
ChatGPT said:
××¢×•×œ×”.
×œ×”×œ×Ÿ ×ª×¡×¨×™×˜ PowerShell ××œ× ×©×¢×•×‘×“ ×›×š:

××” ×”×•× ×¢×•×©×”:

×‘×•×“×§ ×× ×”××©×ª××© ×§×™×™× ×‘-AD

×× ×œ× ×§×™×™× â†’ ×™×•×¦×¨ ××•×ª×•

××•×¡×™×£ ××•×ª×• ×œ×§×‘×•×¦×” X

××¢×“×›×Ÿ ×¡×™×¡××” ×œÖ¾12346

âš ï¸ ×”×¢×¨×” ×—×©×•×‘×” (×œ×¤× ×™ ×”×¡×§×¨×™×¤×˜)
×”×¡×™×¡××” 12346 ×”×™× 5 ×ª×•×•×™×.
×‘×¨×•×‘ ×”×“×•××™×™× ×™× ×–×” ×œ× ×—×•×§×™ ×œ×¤×™ Password Policy (××™× ×™××•× 8).
×× ×”××“×™× ×™×•×ª ×ª×—×¡×•× â€“ ×ª×§×‘×œ ×©×’×™××” (×”×¡×§×¨×™×¤×˜ ×¢×¦××• ×ª×§×™×Ÿ).

×ª×¡×¨×™×˜ PowerShell
Import-Module ActiveDirectory

# ===== ××©×ª× ×™× =====
$UserSam   = "username1"
$UserName  = "User One"
$OU        = "OU=Users,DC=domain,DC=local"
$GroupName = "GroupX"
$Password  = "12346"

# ===== ×‘×“×™×§×ª ××©×ª××© =====
$user = Get-ADUser -Filter "SamAccountName -eq '$UserSam'" -ErrorAction SilentlyContinue

if (-not $user) {
    Write-Host "ğŸ‘¤ ×”××©×ª××© ×œ× ×§×™×™× â€“ ×™×•×¦×¨ ××©×ª××© ×—×“×©"

    $SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

    New-ADUser `
        -SamAccountName $UserSam `
        -Name $UserName `
        -GivenName "User" `
        -Surname "One" `
        -AccountPassword $SecurePass `
        -Enabled $true `
        -Path $OU `
        -ChangePasswordAtLogon $false

    $user = Get-ADUser $UserSam
}
else {
    Write-Host "âœ… ×”××©×ª××© ×›×‘×¨ ×§×™×™×"
}

# ===== ×”×•×¡×¤×” ×œ×§×‘×•×¦×” =====
if (-not (Get-ADGroupMember $GroupName | Where-Object { $_.SamAccountName -eq $UserSam })) {
    Add-ADGroupMember -Identity $GroupName -Members $UserSam
    Write-Host "â• ×”××©×ª××© × ×•×¡×£ ×œ×§×‘×•×¦×” $GroupName"
}
else {
    Write-Host "â„¹ï¸ ×”××©×ª××© ×›×‘×¨ ×—×‘×¨ ×‘×§×‘×•×¦×”"
}

# ===== ×¢×“×›×•×Ÿ ×¡×™×¡××” =====
$SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

Set-ADAccountPassword `
    -Identity $UserSam `
    -NewPassword $SecurePass `
    -Reset

Unlock-ADAccount -Identity $UserSam

Write-Host "ğŸ”‘ ×”×¡×™×¡××” ×¢×•×“×›× ×” ×œÖ¾12346"
×”×ª×××•×ª ××”×™×¨×•×ª ×©×× ×™ ×™×›×•×œ ×œ×¢×©×•×ª ×¢×‘×•×¨×š
âœ” ×§×¨×™××” ×××©×ª× ×” / JSON / CSV
âœ” ×¡×™×¡××” ××§×¨××™×ª ×—×•×§×™×ª ×œ×¤×™ Password Policy
âœ” ×‘×“×™×§×” ××•×˜×•××˜×™×ª ×× ×”××“×™× ×™×•×ª ×××¤×©×¨×ª 5 ×ª×•×•×™×
âœ” ×™×¦×™×¨×ª ×›××” ××©×ª××©×™× ×‘×œ×•×œ××”
âœ” ×œ×•×’ ×œ×§×•×‘×¥

×¨×§ ×ª×’×™×“ ××” ××ª×” ×¨×•×¦×” ×œ×”×•×¡×™×£ ğŸ‘

You said:
Import-Module ActiveDirectory

# ===== ××©×ª× ×™× =====
$User   = "username1"
$OU        = "OU=Users,DC=domain,DC=local"
$GroupName = "GroupX"
$Password  = "12346"

# ===== ×‘×“×™×§×ª ××©×ª××© =====
$user = Get-ADUser -Filter "SamAccountName -eq '$UserSam'" -ErrorAction SilentlyContinue

if (-not $user) {
    Write-Host "ğŸ‘¤ ×”××©×ª××© ×œ× ×§×™×™× â€“ ×™×•×¦×¨ ××©×ª××© ×—×“×©"

    $SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

    New-ADUser 
        -SamAccountName $User 
        -Name $User 
        -GivenName "User" 
        -AccountPassword $SecurePass 
        -Enabled $true 
        -Path $OU 
        -ChangePasswordAtLogon $false

    $user = Get-ADUser $UserSam
}
else {
    Write-Host "âœ… ×”××©×ª××© ×›×‘×¨ ×§×™×™×"
}

# ===== ×”×•×¡×¤×” ×œ×§×‘×•×¦×” =====
if (-not (Get-ADGroupMember $GroupName | Where-Object { $_.SamAccountName -eq $UserSam })) {
    Add-ADGroupMember -Identity $GroupName -Members $UserSam
    Write-Host "â• ×”××©×ª××© × ×•×¡×£ ×œ×§×‘×•×¦×” $GroupName"
}
else {
    Write-Host "â„¹ï¸ ×”××©×ª××© ×›×‘×¨ ×—×‘×¨ ×‘×§×‘×•×¦×”"
}

# ===== ×¢×“×›×•×Ÿ ×¡×™×¡××” =====
$SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

Set-ADAccountPassword 
    -Identity $UserSam 
    -NewPassword $SecurePass 
    -Reset

Unlock-ADAccount -Identity $UserSam

Write-Host "ğŸ”‘ ×”×¡×™×¡××” ×¢×•×“×›× ×” ×œÖ¾12346"
ChatGPT said:
××¦×•×™×Ÿ â€“ ×™×© ×œ×š ×›××Ÿ ×›××” ×©×’×™××•×ª ×§×˜× ×•×ª ××‘×œ ×§×¨×™×˜×™×•×ª, ×‘×¢×™×§×¨ ×—×•×¡×¨ ×¢×§×‘×™×•×ª ×‘×©× ×”××©×ª× ×”.
×× ×™ ××¢×©×” ×œ×š ×¡×“×¨, ××¡×‘×™×¨ ×‘×§×¦×¨×”, ×•××– ××ª×Ÿ ×¡×§×¨×™×¤×˜ ××ª×•×§×Ÿ ×©×¢×•×‘×“.

âŒ ×”×‘×¢×™×•×ª ×‘×§×•×“ ×©×œ×š
×”×’×“×¨×ª:

$User = "username1"
××‘×œ ×‘×”××©×š ××ª×” ××©×ª××© ×‘Ö¾

$UserSam
×©×œ× ×§×™×™× ×‘×›×œ×œ â†’ ×–×” ×™×’×¨×•× ×œ×©×’×™××” / ×”×ª× ×”×’×•×ª ×œ× ×¦×¤×•×™×”.

Get-ADGroupMember ××—×–×™×¨ ××ª ×›×œ ×—×‘×¨×™ ×”×§×‘×•×¦×” â€“ ×¤×—×•×ª ×™×¢×™×œ ×•×™×›×•×œ ×œ×”×™×•×ª ×›×‘×“.

××™×Ÿ Surname ×‘Ö¾New-ADUser (×œ× ×—×•×‘×”, ××‘×œ ××•××œ×¥).

âœ… ×’×¨×¡×” ××ª×•×§× ×ª ×•× ×§×™×™×” (×¢×•×‘×“×ª)
Import-Module ActiveDirectory

# ===== ××©×ª× ×™× =====
$UserSam   = "username1"
$OU        = "OU=Users,DC=domain,DC=local"
$GroupName = "GroupX"
$Password  = "12346"

# ===== ×‘×“×™×§×ª ××©×ª××© =====
$user = Get-ADUser -Filter "SamAccountName -eq '$UserSam'" -ErrorAction SilentlyContinue

if (-not $user) {
    Write-Host "ğŸ‘¤ ×”××©×ª××© ×œ× ×§×™×™× â€“ ×™×•×¦×¨ ××©×ª××© ×—×“×©"

    $SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

    New-ADUser `
        -SamAccountName $UserSam `
        -Name $UserSam `
        -GivenName "User" `
        -Surname "One" `
        -AccountPassword $SecurePass `
        -Enabled $true `
        -Path $OU `
        -ChangePasswordAtLogon $false

    $user = Get-ADUser $UserSam
}
else {
    Write-Host "âœ… ×”××©×ª××© ×›×‘×¨ ×§×™×™×"
}

# ===== ×”×•×¡×¤×” ×œ×§×‘×•×¦×” =====
if (-not (Get-ADUser $UserSam -Properties MemberOf |
          Select-Object -ExpandProperty MemberOf |
          Where-Object { $_ -like "*CN=$GroupName,*" })) {

    Add-ADGroupMember -Identity $GroupName -Members $UserSam
    Write-Host "â• ×”××©×ª××© × ×•×¡×£ ×œ×§×‘×•×¦×” $GroupName"
}
else {
    Write-Host "â„¹ï¸ ×”××©×ª××© ×›×‘×¨ ×—×‘×¨ ×‘×§×‘×•×¦×”"
}

# ===== ×¢×“×›×•×Ÿ ×¡×™×¡××” =====
$SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

Set-ADAccountPassword `
    -Identity $UserSam `
    -NewPassword $SecurePass `
    -Reset

Unlock-ADAccount -Identity $UserSam

Write-Host "ğŸ”‘ ×”×¡×™×¡××” ×¢×•×“×›× ×” ×œÖ¾12346"
âš ï¸ ×ª×–×›×•×¨×ª ×—×©×•×‘×”
×”×¡×™×¡××” 12346:

×§×¦×¨×” ×××•×“

×‘×¨×•×‘ ×”×“×•××™×™× ×™× ×ª×™×›×©×œ ×‘×’×œ×œ Password Policy
×× ×ª×§×‘×œ ×©×’×™××” â€“ ×–×” ×¦×¤×•×™.

×× ××ª×” ×¨×•×¦×” â€“ ×©×“×¨×•×’×™× ××§×¦×•×¢×™×™×
âœ” ×¡×™×¡××” ××§×¨××™×ª ×—×•×§×™×ª ×œ×¤×™ ×”××“×™× ×™×•×ª
âœ” ×‘×“×™×§×” ××¨××© ×©×œ Password Policy
âœ” ×”×¨×¦×” ×¢×œ ×¨×©×™××ª ××©×ª××©×™× (CSV / JSON)
âœ” ×˜×™×¤×•×œ ×‘×©×’×™××•×ª + ×œ×•×’
âœ” ×”×ª×××” ×œÖ¾Jenkins / ××•×˜×•××¦×™×”

×ª×’×™×“ ××” ×”×©×œ×‘ ×”×‘× ğŸ’ª

You said:
×× ×™ ×œ× ××©×ª××© givename  ×•×œ× ×‘ surname
×‘× ×•×¡×£ samAccountname ×¦×¨×™×š ×œ×”×™×•×ª ×–×” ×œname
ChatGPT said:
××¢×•×œ×” ğŸ‘
×× ×›×š â€” ×”× ×” ×¡×§×¨×™×¤×˜ × ×§×™ ×•××“×•×™×§ ×œ×¤×™ ×”×“×¨×™×©×•×ª ×©×œ×š, ×‘×œ×™ GivenName ×•Ö¾Surname,
×•×›××©×¨ SamAccountName = Name (××•×ª×• ×¢×¨×š).

âœ… ×”×ª× ×”×’×•×ª ×”×¡×§×¨×™×¤×˜
×‘×•×“×§ ×× ×”××©×ª××© ×§×™×™×

×× ×œ× ×§×™×™× â†’ ×™×•×¦×¨ ××©×ª××©

Name ×•Ö¾SamAccountName ×–×”×™×

××•×¡×™×£ ×œ×§×‘×•×¦×” X ×× ×¦×¨×™×š

××¢×“×›×Ÿ ×¡×™×¡××” ×œÖ¾12346

âš ï¸ ×”×¢×¨×” ×§×¦×¨×”
12346 ×”×™× ×¡×™×¡××” ×§×¦×¨×” ×××•×“ â€“ ×× ×”××“×™× ×™×•×ª ×ª×—×¡×•×, ×–×• ×œ× ×‘×¢×™×™×ª ×§×•×“.

ğŸŸ¢ ×¡×§×¨×™×¤×˜ PowerShell ××ª×•×§×Ÿ
Import-Module ActiveDirectory

# ===== ××©×ª× ×™× =====
$UserName  = "username1"   # Name ×•×’× SamAccountName
$OU        = "OU=Users,DC=domain,DC=local"
$GroupName = "GroupX"
$Password  = "12346"

# ===== ×‘×“×™×§×ª ××©×ª××© =====
$user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

if (-not $user) {
    Write-Host "ğŸ‘¤ ×”××©×ª××© ×œ× ×§×™×™× â€“ ×™×•×¦×¨ ××©×ª××© ×—×“×©"

    $SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

    New-ADUser `
        -Name $UserName `
        -SamAccountName $UserName `
        -AccountPassword $SecurePass `
        -Enabled $true `
        -Path $OU `
        -ChangePasswordAtLogon $false

    $user = Get-ADUser $UserName
}
else {
    Write-Host "âœ… ×”××©×ª××© ×›×‘×¨ ×§×™×™×"
}

# ===== ×”×•×¡×¤×” ×œ×§×‘×•×¦×” =====
$IsMember = Get-ADUser $UserName -Properties MemberOf |
            Select-Object -ExpandProperty MemberOf |
            Where-Object { $_ -like "*CN=$GroupName,*" }

if (-not $IsMember) {
    Add-ADGroupMember -Identity $GroupName -Members $UserName
    Write-Host "â• ×”××©×ª××© × ×•×¡×£ ×œ×§×‘×•×¦×” $GroupName"
}
else {
    Write-Host "â„¹ï¸ ×”××©×ª××© ×›×‘×¨ ×—×‘×¨ ×‘×§×‘×•×¦×”"
}

# ===== ×¢×“×›×•×Ÿ ×¡×™×¡××” =====
$SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

Set-ADAccountPassword `
    -Identity $UserName `
    -NewPassword $SecurePass `
    -Reset

Unlock-ADAccount -Identity $UserName

Write-Host "ğŸ”‘ ×”×¡×™×¡××” ×¢×•×“×›× ×” ×œÖ¾12346"
×¨×•×¦×” ×©×“×¨×•×’?
×× ×™ ×™×›×•×œ:

×œ×”×¤×•×š ××ª ×–×” ×œ×¤×•× ×§×¦×™×”

×œ×¢×‘×•×“ ×¢× JSON / CSV (×›××• ×©××ª×” ××•×”×‘)

×œ×”×•×¡×™×£ -WhatIf

×œ×•×’ ××¡×•×“×¨

×”×ª×××” ×œ××•×˜×•××¦×™×” ×‘Ö¾Jenkins

×¨×§ ×ª×’×™×“ ğŸš€

You said:
×ª×©× ×” ××ª ×”×›×•×œ ×”×¢×¨×•×ª ×œ×¢×‘×¨×™×ª 
ChatGPT said:
×›××•×‘×Ÿ ğŸ‘
×œ×”×œ×Ÿ ××•×ª×• ×¡×§×¨×™×¤×˜ ×‘×“×™×•×§, ×¢× ×›×œ ×”×”×¢×¨×•×ª ×•×”×”×•×“×¢×•×ª ×‘×¢×‘×¨×™×ª, ×‘×œ×™ GivenName ×•Ö¾Surname,
×•×›××©×¨ Name = SamAccountName.

ğŸŸ¢ ×¡×§×¨×™×¤×˜ PowerShell â€“ ×¢× ×”×¢×¨×•×ª ×‘×¢×‘×¨×™×ª
Import-Module ActiveDirectory

# ===== ××©×ª× ×™× =====
$UserName  = "username1"   # ×©× ×”××©×ª××© (×’× Name ×•×’× SamAccountName)
$OU        = "OU=Users,DC=domain,DC=local"
$GroupName = "GroupX"      # ×©× ×”×§×‘×•×¦×”
$Password  = "12346"       # ×¡×™×¡××” ×—×“×©×”

# ===== ×‘×“×™×§×” ×”×× ×”××©×ª××© ×§×™×™× =====
$user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

if (-not $user) {
    Write-Host "ğŸ‘¤ ×”××©×ª××© ×œ× ×§×™×™× â€“ ××ª×‘×¦×¢×ª ×™×¦×™×¨×ª ××©×ª××© ×—×“×©"

    # ×”××¨×ª ×”×¡×™×¡××” ×œ××‘× ×” ×××•×‘×˜×—
    $SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

    # ×™×¦×™×¨×ª ××©×ª××© ×—×“×©
    New-ADUser `
        -Name $UserName `
        -SamAccountName $UserName `
        -AccountPassword $SecurePass `
        -Enabled $true `
        -Path $OU `
        -ChangePasswordAtLogon $false

    # ×˜×¢×™× ×ª ×”××©×ª××© ××—×“×© ×œ××—×¨ ×™×¦×™×¨×”
    $user = Get-ADUser $UserName
}
else {
    Write-Host "âœ… ×”××©×ª××© ×›×‘×¨ ×§×™×™×"
}

# ===== ×‘×“×™×§×” ×•×”×•×¡×¤×” ×œ×§×‘×•×¦×” =====
$IsMember = Get-ADUser $UserName -Properties MemberOf |
            Select-Object -ExpandProperty MemberOf |
            Where-Object { $_ -like "*CN=$GroupName,*" }

if (-not $IsMember) {
    Add-ADGroupMember -Identity $GroupName -Members $UserName
    Write-Host "â• ×”××©×ª××© × ×•×¡×£ ×œ×§×‘×•×¦×” $GroupName"
}
else {
    Write-Host "â„¹ï¸ ×”××©×ª××© ×›×‘×¨ ×—×‘×¨ ×‘×§×‘×•×¦×”"
}

# ===== ×¢×“×›×•×Ÿ ×¡×™×¡××” =====
$SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

Set-ADAccountPassword `
    -Identity $UserName `
    -NewPassword $SecurePass `
    -Reset

# ×‘×™×˜×•×œ × ×¢×™×œ×ª ×”××©×ª××© (×× ×”×™×” × ×¢×•×œ)
Unlock-ADAccount -Identity $UserName

Write-Host "ğŸ”‘ ×”×¡×™×¡××” ×¢×•×“×›× ×” ×‘×”×¦×œ×—×”"
âš ï¸ ×ª×–×›×•×¨×ª ×§×¦×¨×”
×”×¡×™×¡××” 12346 ×§×¦×¨×” ×××•×“
×× ×”××“×™× ×™×•×ª ×‘×“×•××™×™×Ÿ ×œ× ×××¤×©×¨×ª â€“ ×ª×ª×§×‘×œ ×©×’×™××” (×•×–×” ×ª×§×™×Ÿ).

×× ×ª×¨×¦×”:

×¤×•× ×§×¦×™×” ×›×œ×œ×™×ª

×¢×‘×•×“×” ×¢× ×§×•×‘×¥ ××©×ª××©×™×

×‘×“×™×§×ª Password Policy ××¨××©

×œ×•×’ ××¡×•×“×¨ ×œ×§×•×‘×¥

×”×¨×¦×” ×‘×˜×•×—×” (-WhatIf)

×¨×§ ×ª×’×™×“ ğŸ‘Œ

You said:
×¡×œ×™×—×” ×‘×œ×™ ×¢×‘×¨×™×ª
ChatGPT said:
××™×Ÿ ×‘×¢×™×” ğŸ™‚
×œ×”×œ×Ÿ ×”×¡×§×¨×™×¤×˜ ×”×¡×•×¤×™ ×‘×œ×™ ×¢×‘×¨×™×ª ×‘×›×œ×œ â€“ ×›×œ ×”×”×¢×¨×•×ª ×•×”×”×•×“×¢×•×ª ×‘×× ×’×œ×™×ª ×‘×œ×‘×“,
×œ×œ× GivenName / Surname, ×•Ö¾Name = SamAccountName.

PowerShell Script
Import-Module ActiveDirectory

# ===== Variables =====
$UserName  = "username1"   # Name and SamAccountName
$OU        = "OU=Users,DC=domain,DC=local"
$GroupName = "GroupX"      # Group name
$Password  = "12346"       # New password

# ===== Check if user exists =====
$user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

if (-not $user) {
    Write-Host "User does not exist - creating new user"

    # Convert password to secure string
    $SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

    # Create new user
    New-ADUser `
        -Name $UserName `
        -SamAccountName $UserName `
        -AccountPassword $SecurePass `
        -Enabled $true `
        -Path $OU `
        -ChangePasswordAtLogon $false

    # Reload user after creation
    $user = Get-ADUser $UserName
}
else {
    Write-Host "User already exists"
}

# ===== Check and add user to group =====
$IsMember = Get-ADUser $UserName -Properties MemberOf |
            Select-Object -ExpandProperty MemberOf |
            Where-Object { $_ -like "*CN=$GroupName,*" }

if (-not $IsMember) {
    Add-ADGroupMember -Identity $GroupName -Members $UserName
    Write-Host "User added to group $GroupName"
}
else {
    Write-Host "User is already a member of the group"
}

# ===== Reset password =====
$SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

Set-ADAccountPassword `
    -Identity $UserName `
    -NewPassword $SecurePass `
    -Reset

# Unlock account if locked
Unlock-ADAccount -Identity $UserName

Write-Host "Password updated successfully"
If you want:

Password generated according to domain policy

CSV / JSON input

Function-based version

Logging to file

Jenkins automation-ready version

Just tell me ğŸ‘

You said:
 JENKINS + ×œ×”×¢×‘×™×¨ ×§×‘×•×¦×” ×©×œ ××©×ª××©×™× ×œ×”×©×ª××© ×“×¨×š 
ChatGPT said:
×”×‘× ×ª×™ ğŸ‘
××ª×” ×¨×•×¦×” Jenkins ×©×™×¨×™×¥ ××ª ×”×¡×§×¨×™×¤×˜ ×•×™×¢×‘×™×¨ ×§×‘×•×¦×” ×©×œ ××©×ª××©×™× ×›×§×œ×˜.

×œ×”×œ×Ÿ ×¤×ª×¨×•×Ÿ ××§×¦×•×¢×™ ×•× ×¤×•×¥:
Jenkins Pipeline ×©××§×‘×œ ×¨×©×™××ª ××©×ª××©×™× ×›-Parameter ×•××¢×‘×“ ××—×“Ö¾××—×“ ××•×œ AD.

ğŸ§© ××‘× ×” ×”×¤×ª×¨×•×Ÿ
Jenkins job (Pipeline)

Parameter ××¡×•×’ Multi-line string

×›×œ ×©×•×¨×” = ××©×ª××© AD ××—×“

Jenkins ××¨×™×¥ PowerShell ×¢×œ Windows Agent ×¢× RSAT

1ï¸âƒ£ Jenkins Parameters
×‘Ö¾Pipeline â†’ Parameters ×”×•×¡×£:

String Parameter

Name: USERS

Description: List of AD users (one per line)

Default value:

user1
user2
user3
2ï¸âƒ£ Jenkinsfile (Pipeline)
pipeline {
    agent { label 'windows' }

    parameters {
        text(
            name: 'USERS',
            description: 'List of AD users (one per line)'
        )
    }

    stages {
        stage('AD User Management') {
            steps {
                powershell '''
Import-Module ActiveDirectory

$OU        = "OU=Users,DC=domain,DC=local"
$GroupName = "GroupX"
$Password  = "12346"

$Users = $env:USERS -split "`r?`n" | Where-Object { $_ -ne "" }

foreach ($UserName in $Users) {

    Write-Host "Processing user: $UserName"

    $user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

    if (-not $user) {
        Write-Host "User does not exist - creating"

        $SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

        New-ADUser `
            -Name $UserName `
            -SamAccountName $UserName `
            -AccountPassword $SecurePass `
            -Enabled $true `
            -Path $OU `
            -ChangePasswordAtLogon $false
    }

    $IsMember = Get-ADUser $UserName -Properties MemberOf |
                Select-Object -ExpandProperty MemberOf |
                Where-Object { $_ -like "*CN=$GroupName,*" }

    if (-not $IsMember) {
        Add-ADGroupMember -Identity $GroupName -Members $UserName
        Write-Host "Added to group $GroupName"
    }

    Set-ADAccountPassword `
        -Identity $UserName `
        -NewPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
        -Reset

    Unlock-ADAccount -Identity $UserName
}
'''
            }
        }
    }
}
3ï¸âƒ£ ××™×š ×–×” ×¢×•×‘×“ ×‘×¤×•×¢×œ
××¤×¢×™×œ Job ×‘-Jenkins

××“×‘×™×§ ×¨×©×™××ª ××©×ª××©×™×:

test01
test02
test03
Jenkins:

×™×•×¦×¨ ××©×ª××© ×× ×œ× ×§×™×™×

××•×¡×™×£ ×œ×§×‘×•×¦×” GroupX

×××¤×¡ ×¡×™×¡××”

×¤×•×ª×— × ×¢×™×œ×”

âš ï¸ ×”×¢×¨×•×ª ×—×©×•×‘×•×ª
Agent ×—×™×™×‘ ×œ×”×™×•×ª:

Windows

×¢× RSAT / ActiveDirectory module

×”×¡×™×¡××” 12346 ×¢×œ×•×œ×” ×œ×”×™×—×¡× ×¢"×™ Password Policy

Jenkins service ×¦×¨×™×š ×œ×¨×•×¥ ×¢× ×”×¨×©××•×ª AD ××ª××™××•×ª

×©×“×¨×•×’×™× ××¤×©×¨×™×™× (××•××œ×¥)
âœ” ×¡×™×¡××” ××§×¨××™×ª ×œ×›×œ ××©×ª××©
âœ” ×§×¨×™××” ×-CSV / JSON
âœ” dry-run (WhatIf)
âœ” ×œ×•×’ ×œ×§×•×‘×¥ + Artifact
âœ” Creds ×©×œ Jenkins ×‘××§×•× ×¡×™×¡××” ×‘×§×•×“

×× ××ª×” ×¨×•×¦×” â€“ ××’×™×“ ×œ×š ××” ×”×’×¨×¡×” ×”×›×™ ×‘×˜×•×—×” ×œ××¨×’×•×Ÿ ×•××‘× ×” ×œ×š ××•×ª×” ×¦×¢×“-×¦×¢×“ ğŸ‘Œ

You said:
×‘× ×•×¡×£ ×¡×™×¡××” ×©×¢×•××“×ª ×‘×ª× ××™× ×©×œ ××“×™× ×™×•×ª ×¡×™×¡×××•×ª 
Aa123456!
ChatGPT said:
××¢×•×œ×” âœ”ï¸
× ×¢×“×›×Ÿ ××ª ×”×¤×ª×¨×•×Ÿ ×›×š ×©×”×¡×™×¡××” ×ª×”×™×” ×—×–×§×” ×•×¢×•××“×ª ×‘××“×™× ×™×•×ª ×¡×™×¡×××•×ª × ×¤×•×¦×”
(Aa123456! â€“ ××•×ª ×’×“×•×œ×”, ×§×˜× ×”, ××¡×¤×¨×™×, ×ª×• ××™×•×—×“, ×•××•×¨×š â‰¥ 8).

×œ×”×œ×Ÿ Jenkins Pipeline ××¢×•×“×›×Ÿ ×¢× ×”×¡×™×¡××” ×”×—×“×©×”.

Jenkinsfile â€“ AD User Management (Password Policy Compliant)
pipeline {
    agent { label 'windows' }

    parameters {
        text(
            name: 'USERS',
            description: 'List of AD users (one per line)'
        )
    }

    stages {
        stage('AD User Management') {
            steps {
                powershell '''
Import-Module ActiveDirectory

$OU        = "OU=Users,DC=domain,DC=local"
$GroupName = "GroupX"
$Password  = "Aa123456!"   # Password compliant with common AD policies

$Users = $env:USERS -split "`r?`n" | Where-Object { $_ -ne "" }

foreach ($UserName in $Users) {

    Write-Host "Processing user: $UserName"

    $user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

    if (-not $user) {
        Write-Host "User does not exist - creating"

        $SecurePass = ConvertTo-SecureString $Password -AsPlainText -Force

        New-ADUser `
            -Name $UserName `
            -SamAccountName $UserName `
            -AccountPassword $SecurePass `
            -Enabled $true `
            -Path $OU `
            -ChangePasswordAtLogon $false
    }

    $IsMember = Get-ADUser $UserName -Properties MemberOf |
                Select-Object -ExpandProperty MemberOf |
                Where-Object { $_ -like "*CN=$GroupName,*" }

    if (-not $IsMember) {
        Add-ADGroupMember -Identity $GroupName -Members $UserName
        Write-Host "Added to group $GroupName"
    }

    Set-ADAccountPassword `
        -Identity $UserName `
        -NewPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
        -Reset

    Unlock-ADAccount -Identity $UserName
}
'''
            }
        }
    }
}
âœ”ï¸ ×œ××” ×”×¡×™×¡××” ×”×–×• ×ª×§×™× ×”
Aa123456! ×›×•×œ×œ:

××•×ª ×’×“×•×œ×” âœ”

××•×ª ×§×˜× ×” âœ”

××¡×¤×¨×™× âœ”

×ª×• ××™×•×—×“ âœ”

9 ×ª×•×•×™× âœ”

××ª××™× ×œÖ¾Default Domain Password Policy ×‘×¨×•×‘ ×”××¨×’×•× ×™×.

ğŸ” ×©×“×¨×•×’ ××‘×˜×—×ª×™ ××•××œ×¥ (×œ-production)
×× ×ª×¨×¦×”, ××•×›×œ:

×œ×™×™×¦×¨ ×¡×™×¡××” ××§×¨××™×ª ×™×™×—×•×“×™×ª ×œ×›×œ ××©×ª××©

×œ×©××•×¨ ×¡×™×¡×××•×ª ×›Ö¾Jenkins Credentials

×œ×›×ª×•×‘ ×¡×™×¡×××•×ª ×œ×§×•×‘×¥ ××•×¦×¤×Ÿ ×›Ö¾Artifact

×œ××›×•×£ ChangePasswordAtLogon = $true

×ª×’×™×“ ××” ×”×›×™×•×•×Ÿ ×”×‘× ×•××ª××™× ××ª ×–×” ×‘×“×™×•×§ ×œ××¨×’×•×Ÿ ×©×œ×š ğŸ’ª

You said:
×× ×™ ×©××¨×•×– ××ª ×”×¤×™×¤×œ×™×™×Ÿ ×›best practis
ChatGPT said:
××¢×•×œ×” â€” ×‘×•× × ××¨×•×– ××ª ×–×” ×›-Best Practice ×××™×ª×™ ×œ××¨×’×•×Ÿ âœ…
××”×¡×•×’ ×©××¤×©×¨ ×œ×©×™× ×‘×¤×¨×•×“×§×©×Ÿ ×‘×œ×™ ×œ×”×ª×‘×™×™×©.

×œ×”×œ×Ÿ ×¢×§×¨×•× ×•×ª + Pipeline ××•×›×Ÿ.

âœ… Best Practices â€“ Jenkins + AD
×¢×§×¨×•× ×•×ª ×©×‘×™×¦×¢× ×•
âœ” ××™×Ÿ ×¡×™×¡××” ×‘×§×•×“
âœ” ×©×™××•×© ×‘-Jenkins Credentials
âœ” Pipeline ×§×¨×™×, × ×™×ª×Ÿ ×œ×ª×—×–×•×§×”
âœ” ×ª××™×›×” ×‘×¨×©×™××ª ××©×ª××©×™×
âœ” ×”×¨×¦×” ×‘×˜×•×—×” ×¢×œ Windows Agent
âœ” ×”×¤×¨×“×” ×‘×™×Ÿ Jenkinsfile ×œ×¡×§×¨×™×¤×˜ ×œ×•×’×™

1ï¸âƒ£ Jenkins Credentials (×—×•×‘×”)
×‘-Jenkins:

Manage Jenkins â†’ Credentials

×”×•×¡×£ Secret Text

ID: AD_DEFAULT_PASSWORD

Value:

Aa123456!
××¤×©×¨ ×’× ×œ×”×—×œ×™×£ ×‘×”××©×š ×œÖ¾Password Generator ×‘×œ×™ ×©×™× ×•×™ Pipeline.

2ï¸âƒ£ Jenkinsfile â€“ Best Practice Version
pipeline {
    agent { label 'windows' }

    parameters {
        text(
            name: 'USERS',
            description: 'AD users list (one per line)'
        )
    }

    environment {
        OU        = 'OU=Users,DC=domain,DC=local'
        GROUP     = 'GroupX'
    }

    stages {
        stage('Manage AD Users') {
            steps {
                withCredentials([
                    string(credentialsId: 'AD_DEFAULT_PASSWORD', variable: 'DEFAULT_PASSWORD')
                ]) {
                    powershell '''
Import-Module ActiveDirectory

$Users = $env:USERS -split "`r?`n" | Where-Object { $_.Trim() -ne "" }
$OU        = $env:OU
$GroupName = $env:GROUP
$Password  = $env:DEFAULT_PASSWORD

foreach ($UserName in $Users) {

    Write-Host "=== Processing user: $UserName ==="

    $user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

    if (-not $user) {
        Write-Host "User not found - creating user"

        New-ADUser `
            -Name $UserName `
            -SamAccountName $UserName `
            -AccountPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
            -Enabled $true `
            -Path $OU `
            -ChangePasswordAtLogon $true
    }

    $IsMember = Get-ADUser $UserName -Properties MemberOf |
                Select-Object -ExpandProperty MemberOf |
                Where-Object { $_ -like "*CN=$GroupName,*" }

    if (-not $IsMember) {
        Add-ADGroupMember -Identity $GroupName -Members $UserName
        Write-Host "Added to group $GroupName"
    }

    Set-ADAccountPassword `
        -Identity $UserName `
        -NewPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
        -Reset

    Unlock-ADAccount -Identity $UserName
}
'''
                }
            }
        }
    }

    post {
        success {
            echo 'AD user management completed successfully'
        }
        failure {
            echo 'AD user management failed'
        }
    }
}
3ï¸âƒ£ ×œ××” ×–×” Best Practice ×××™×ª×™
× ×•×©×	×œ××” ×–×” × ×›×•×Ÿ
Credentials	××™×Ÿ ×¡×™×¡×××•×ª ×‘×§×•×“
Parameters	×©×œ×™×˜×” ××œ××” ×‘×”×¨×¦×”
Environment	×©×™× ×•×™ ×§×œ ×‘×™×Ÿ ×¡×‘×™×‘×•×ª
withCredentials	××‘×˜×—×” + Audit
ChangePasswordAtLogon	××‘×˜×—×ª ××©×ª××©×™×
Agent Label	×¨×¥ ×¨×§ ××™×¤×” ×©×¦×¨×™×š
ğŸ” ×©×“×¨×•×’×™× ×œ×¤×¨×•×“×§×©×Ÿ ×›×‘×“
×× ×ª×¨×¦×” ×œ×”×’×™×¢ ×œ-Enterprise Level:

ğŸ”„ Password Generator ×œ×¤×™ Domain Policy

ğŸ“„ CSV / JSON input

ğŸ§ª -WhatIf Mode

ğŸ§¾ Log ×œ×§×•×‘×¥ + Artifact

ğŸ‘®â€â™‚ï¸ Role Based Jenkins Jobs

ğŸ” Service Account ×™×™×¢×•×“×™ ×œ-AD

×× ×ª×¨×¦×” â€” ×× ×™ ×™×›×•×œ ×œ×”×›×™×Ÿ ×œ×š Template ××¨×’×•× ×™ ××• Library ××©×•×ª×¤×ª ×œ-Jenkins ğŸ‘Œ

You said:
×’× ××—×™×§×” ×©×œ ×”workspace
ChatGPT said:
××¢×•×œ×” ğŸ’ª
×‘-Best Practice Pipeline ××•×¡×™×¤×™× × ×™×§×•×™ ×©×œ ×”-workspace ×‘×ª×—×™×œ×ª ××• ×‘×¡×™×•× ×”×¨×™×¦×”, ×›×“×™ ×œ×× ×•×¢ ×–×™×”×•× ×©×œ ×§×‘×¦×™× ×™×©× ×™× ×•×œ×”×‘×˜×™×— ×©×”-run ×ª××™×“ × ×§×™.

×œ×”×œ×Ÿ ×’×¨×¡×” ××¢×•×“×›× ×ª ×©×œ ×”-Best Practice Pipeline ×¢× × ×™×§×•×™ workspace ×‘×¡×•×£:

Jenkinsfile â€“ ×¢× × ×™×§×•×™ Workspace
pipeline {
    agent { label 'windows' }

    parameters {
        text(
            name: 'USERS',
            description: 'AD users list (one per line)'
        )
    }

    environment {
        OU        = 'OU=Users,DC=domain,DC=local'
        GROUP     = 'GroupX'
    }

    stages {
        stage('Manage AD Users') {
            steps {
                withCredentials([
                    string(credentialsId: 'AD_DEFAULT_PASSWORD', variable: 'DEFAULT_PASSWORD')
                ]) {
                    powershell '''
Import-Module ActiveDirectory

$Users = $env:USERS -split "`r?`n" | Where-Object { $_.Trim() -ne "" }
$OU        = $env:OU
$GroupName = $env:GROUP
$Password  = $env:DEFAULT_PASSWORD

foreach ($UserName in $Users) {

    Write-Host "=== Processing user: $UserName ==="

    $user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

    if (-not $user) {
        Write-Host "User not found - creating user"

        New-ADUser `
            -Name $UserName `
            -SamAccountName $UserName `
            -AccountPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
            -Enabled $true `
            -Path $OU `
            -ChangePasswordAtLogon $true
    }

    $IsMember = Get-ADUser $UserName -Properties MemberOf |
                Select-Object -ExpandProperty MemberOf |
                Where-Object { $_ -like "*CN=$GroupName,*" }

    if (-not $IsMember) {
        Add-ADGroupMember -Identity $GroupName -Members $UserName
        Write-Host "Added to group $GroupName"
    }

    Set-ADAccountPassword `
        -Identity $UserName `
        -NewPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
        -Reset

    Unlock-ADAccount -Identity $UserName
}
'''
                }
            }
        }
    }

    post {
        success {
            echo 'AD user management completed successfully'
            cleanWs() // âœ… Clean workspace after successful run
        }
        failure {
            echo 'AD user management failed'
            cleanWs() // âœ… Also clean workspace after failure
        }
    }
}
ğŸ”¹ ×”×¡×‘×¨×™×
cleanWs()

×–×• ×¤×•× ×§×¦×™×” ×©×œ Pipeline ×©××•×—×§×ª ××ª ×›×œ ×”×§×‘×¦×™× ×‘-workspace

××•××œ×¥ ×ª××™×“ ×‘×¡×™×•× ×”×¨×™×¦×”, ×’× ×× ×”×™×™×ª×” ×©×’×™××”

×œ××” ×–×” Best Practice

××‘×˜×™×— ×¨×™×¦×” × ×§×™×™×” ×‘×›×œ ×¤×¢×

××•× ×¢ â€œspilloverâ€ ×©×œ ×§×‘×¦×™× ××”-run ×§×•×“×

××ª××™× ×‘××™×•×—×“ ×›×©×¢×•×‘×“×™× ×¢× ×¡×§×¨×™×¤×˜×™× ×©×™×•×¦×¨×™× ×§×‘×¦×™× ×–×× ×™×™× ××• CSV

×× ×ª×¨×¦×”, ×× ×™ ×™×›×•×œ ×œ×”×›×™×Ÿ ×’×¨×¡×” ××œ××” ×¢×:

×¢×‘×•×“×” ×¢×œ CSV/JSON ×©×œ ××©×ª××©×™×

×¡×™×¡××” ××§×¨××™×ª ×œ×›×œ ××©×ª××©

Dry-run / WhatIf Mode

Logging ××¡×•×“×¨ ×¢× Artifact

×›×š ×™×”×™×” ×œ×š Pipeline ××§×¦×•×¢×™ ×•××•×›×Ÿ ×œ××¨×’×•×Ÿ.

×¨×•×¦×” ×©××›×™×Ÿ ××ª ×–×”?

You said:
×ª×™×™×©×¨×™ ×œ×™×•×¤×™ 
ChatGPT said:
×‘×•×•×“××™ âœ…
×× ×™ ××™×™×©×¨ ××ª ×”-Jenkinsfile, ××“××’ ×©×”-indentations ×•×”-format ×™×”×™×• × ×§×™×™×, ×§×¨×™××™× ×•××¡×•×“×¨×™×, ×›×š ×©×™×”×™×” â€œ×™×¤×”â€ ×•× ×•×— ×œ×§×¨×™××” ×•×ª×—×–×•×§×”.

Jenkinsfile â€“ ××¡×•×“×¨ ×•×™×¤×”
pipeline {
    agent { label 'windows' }

    parameters {
        text(
            name: 'USERS',
            description: 'AD users list (one per line)'
        )
    }

    environment {
        OU    = 'OU=Users,DC=domain,DC=local'
        GROUP = 'GroupX'
    }

    stages {
        stage('Manage AD Users') {
            steps {
                withCredentials([string(credentialsId: 'AD_DEFAULT_PASSWORD', variable: 'DEFAULT_PASSWORD')]) {
                    powershell '''
Import-Module ActiveDirectory

# Split users list from Jenkins parameter
$Users     = $env:USERS -split "`r?`n" | Where-Object { $_.Trim() -ne "" }
$OU        = $env:OU
$GroupName = $env:GROUP
$Password  = $env:DEFAULT_PASSWORD

foreach ($UserName in $Users) {
    Write-Host "=== Processing user: $UserName ==="

    # Check if user exists
    $user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

    if (-not $user) {
        Write-Host "User not found - creating user"

        New-ADUser `
            -Name $UserName `
            -SamAccountName $UserName `
            -AccountPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
            -Enabled $true `
            -Path $OU `
            -ChangePasswordAtLogon $true
    }

    # Check if user is already in group
    $IsMember = Get-ADUser $UserName -Properties MemberOf |
                Select-Object -ExpandProperty MemberOf |
                Where-Object { $_ -like "*CN=$GroupName,*" }

    if (-not $IsMember) {
        Add-ADGroupMember -Identity $GroupName -Members $UserName
        Write-Host "Added to group $GroupName"
    }

    # Reset password and unlock account
    Set-ADAccountPassword `
        -Identity $UserName `
        -NewPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
        -Reset

    Unlock-ADAccount -Identity $UserName
}
'''
                }
            }
        }
    }

    post {
        success {
            echo 'AD user management completed successfully'
            cleanWs() // Clean workspace after successful run
        }
        failure {
            echo 'AD user management failed'
            cleanWs() // Also clean workspace after failure
        }
    }
}
ğŸ”¹ ××” × ×¢×©×” ×¤×”
Indentation ×¢×§×‘×™ â€“ 4 ×¨×•×•×—×™× ×‘×›×œ level

×”×¢×¨×•×ª ×§×¦×¨×•×ª ×œ×›×œ ×‘×œ×•×§

withCredentials ×•-powershell ××¡×•×“×¨×™×

post ××¡×•×“×¨ ×¢× cleanWs() ×‘×©× ×™ ××¦×‘×™×

×× ×ª×¨×¦×”, ×× ×™ ×™×›×•×œ ×’× ×œ×”×›×™×Ÿ ×’×¨×¡×” â€œUltra Cleanâ€ ×¢×:

×¤×•× ×§×¦×™×•×ª PowerShell ×¤× ×™××™×•×ª (×œ×™×¦×™×¨×”, ×”×•×¡×¤×” ×œ×§×‘×•×¦×”, ×¢×“×›×•×Ÿ ×¡×™×¡××”)

Dry-run / Logging ××¡×•×“×¨

×§×¨×™××” ××§×•×‘×¥ CSV / JSON

×–×” ×™×”×¤×•×š ××ª ×”-Pipeline ×œ××§×¦×•×¢×™ ×œ×—×œ×•×˜×™×Ÿ ğŸ‘Œ

×¨×•×¦×” ×©××¢×©×” ××ª ×–×”?

You said:
×ª× ×§×” ×”×•×¨××•×ª ×•××œ ×ª×©××© ×‘×¢×‘×¨×™×ª 
ChatGPT said:
Got it âœ…
Hereâ€™s a clean, fully aligned Jenkinsfile, all in English, no extra instructions or comments:

pipeline {
    agent { label 'windows' }

    parameters {
        text(
            name: 'USERS',
            description: 'AD users list (one per line)'
        )
    }

    environment {
        OU    = 'OU=Users,DC=domain,DC=local'
        GROUP = 'GroupX'
    }

    stages {
        stage('Manage AD Users') {
            steps {
                withCredentials([string(credentialsId: 'AD_DEFAULT_PASSWORD', variable: 'DEFAULT_PASSWORD')]) {
                    powershell '''
Import-Module ActiveDirectory

$Users     = $env:USERS -split "`r?`n" | Where-Object { $_.Trim() -ne "" }
$OU        = $env:OU
$GroupName = $env:GROUP
$Password  = $env:DEFAULT_PASSWORD

foreach ($UserName in $Users) {

    $user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

    if (-not $user) {
        New-ADUser `
            -Name $UserName `
            -SamAccountName $UserName `
            -AccountPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
            -Enabled $true `
            -Path $OU `
            -ChangePasswordAtLogon $true
    }

    $IsMember = Get-ADUser $UserName -Properties MemberOf |
                Select-Object -ExpandProperty MemberOf |
                Where-Object { $_ -like "*CN=$GroupName,*" }

    if (-not $IsMember) {
        Add-ADGroupMember -Identity $GroupName -Members $UserName
    }

    Set-ADAccountPassword `
        -Identity $UserName `
        -NewPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
        -Reset

    Unlock-ADAccount -Identity $UserName
}
'''
                }
            }
        }
    }

    post {
        success {
            cleanWs()
        }
        failure {
            cleanWs()
        }
    }
}
This is now clean, aligned, fully in English, ready to use in Jenkins.

You said:
×ª×©×ª××© ×‘×”×¨××•×ª ×‘×¢×‘×¨×™×ª 
ChatGPT said:
×›××•×‘×Ÿ âœ…
×œ×”×œ×Ÿ ×”×’×¨×¡×” ×”××¡×•×“×¨×ª ×©×œ ×”-Jenkinsfile ×¢× ×”×•×“×¢×•×ª ×•×”×¢×¨×•×ª ×‘×¢×‘×¨×™×ª, × ×§×™ ×•××™×•×©×¨:

pipeline {
    agent { label 'windows' }

    parameters {
        text(
            name: 'USERS',
            description: '×¨×©×™××ª ××©×ª××©×™ AD (××©×ª××© ××—×“ ×‘×›×œ ×©×•×¨×”)'
        )
    }

    environment {
        OU    = 'OU=Users,DC=domain,DC=local'
        GROUP = 'GroupX'
    }

    stages {
        stage('× ×™×”×•×œ ××©×ª××©×™ AD') {
            steps {
                withCredentials([string(credentialsId: 'AD_DEFAULT_PASSWORD', variable: 'DEFAULT_PASSWORD')]) {
                    powershell '''
Import-Module ActiveDirectory

$Users     = $env:USERS -split "`r?`n" | Where-Object { $_.Trim() -ne "" }
$OU        = $env:OU
$GroupName = $env:GROUP
$Password  = $env:DEFAULT_PASSWORD

foreach ($UserName in $Users) {

    Write-Host "=== ××¢×‘×“ ××©×ª××©: $UserName ==="

    $user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

    if (-not $user) {
        Write-Host "××©×ª××© ×œ× × ××¦× â€“ ×™×•×¦×¨ ××©×ª××© ×—×“×©"

        New-ADUser `
            -Name $UserName `
            -SamAccountName $UserName `
            -AccountPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
            -Enabled $true `
            -Path $OU `
            -ChangePasswordAtLogon $true
    }

    $IsMember = Get-ADUser $UserName -Properties MemberOf |
                Select-Object -ExpandProperty MemberOf |
                Where-Object { $_ -like "*CN=$GroupName,*" }

    if (-not $IsMember) {
        Add-ADGroupMember -Identity $GroupName -Members $UserName
        Write-Host "â• ×”××©×ª
You said:
×œ× ×× ×’×œ×™×ª 
ChatGPT said:
×”×‘× ×ª×™ âœ…
×œ×”×œ×Ÿ ×”×’×¨×¡×” ×”××¡×•×“×¨×ª ×©×œ ×”-Jenkinsfile ×‘×›×•×œ×• ×‘×¢×‘×¨×™×ª, ×›×•×œ×œ ×”×•×“×¢×•×ª ×•×›×œ ×”×˜×§×¡×˜×™×:

pipeline {
    agent { label 'windows' }

    parameters {
        text(
            name: 'USERS',
            description: '×¨×©×™××ª ××©×ª××©×™ AD (××©×ª××© ××—×“ ×‘×›×œ ×©×•×¨×”)'
        )
    }

    environment {
        OU    = 'OU=Users,DC=domain,DC=local'
        GROUP = 'GroupX'
    }

    stages {
        stage('× ×™×”×•×œ ××©×ª××©×™ AD') {
            steps {
                withCredentials([string(credentialsId: 'AD_DEFAULT_PASSWORD', variable: 'DEFAULT_PASSWORD')]) {
                    powershell '''
Import-Module ActiveDirectory

$Users     = $env:USERS -split "`r?`n" | Where-Object { $_.Trim() -ne "" }
$OU        = $env:OU
$GroupName = $env:GROUP
$Password  = $env:DEFAULT_PASSWORD

foreach ($UserName in $Users) {

    Write-Host "=== ××¢×‘×“ ××©×ª××©: $UserName ==="

    $user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

    if (-not $user) {
        Write-Host "××©×ª××© ×œ× × ××¦× â€“ ×™×•×¦×¨ ××©×ª××© ×—×“×©"

        New-ADUser `
            -Name $UserName `
            -SamAccountName $UserName `
            -AccountPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
            -Enabled $true `
            -Path $OU `
            -ChangePasswordAtLogon $true
    }
    else {
        Write-Host "âœ… ×”××©×ª××© ×›×‘×¨ ×§×™×™×"
    }

    $IsMember = Get-ADUser $UserName -Properties MemberOf |
                Select-Object -ExpandProperty MemberOf |
                Where-Object { $_ -like "*CN=$GroupName,*" }

    if (-not $IsMember) {
        Add-ADGroupMember -Identity $GroupName -Members $UserName
        Write-Host "â• ×”××©×ª××© × ×•×¡×£ ×œ×§×‘×•×¦×” $GroupName"
    }
    else {
        Write-Host "â„¹ï¸ ×”××©×ª××© ×›×‘×¨ ×—×‘×¨ ×‘×§×‘×•×¦×”"
    }

    Set-ADAccountPassword `
        -Identity $UserName `
        -NewPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
        -Reset

    Unlock-ADAccount -Identity $UserName
    Write-Host "ğŸ”‘ ×¡×™×¡××” ×¢×•×“×›× ×”"
}
'''
                }
            }
        }
    }

    post {
        success {
            echo '× ×™×”×•×œ ××©×ª××©×™ AD ×”×¡×ª×™×™× ×‘×”×¦×œ×—×”'
            cleanWs()
        }
        failure {
            echo '× ×™×”×•×œ ××©×ª××©×™ AD × ×›×©×œ'
            cleanWs()
        }
    }
}
×›×œ ×”×”×•×“×¢×•×ª, echo ×•Ö¾Write-Host ×¢×‘×¨×• ×œ×¢×‘×¨×™×ª

Pipeline ××•×›×Ÿ ×œ×”×¨×¦×” ×¢× ×¨×©×™××ª ××©×ª××©×™×

Workspace ×× ×•×§×” ×‘×¡×™×•× ×‘×›×œ ××¦×‘

×× ×ª×¨×¦×”, ×× ×™ ×™×›×•×œ ×œ×”×›×™×Ÿ ×’×¨×¡×” × ×•×¡×¤×ª ×¢× ×§×¨×™××” ××§×•×‘×¥ CSV/JSON ×’× ×‘×¢×‘×¨×™×ª, ×›×š ×©×”×¨×¦×” ×¢×œ ×××•×ª ××©×ª××©×™× ×ª×”×™×” ××•×˜×•××˜×™×ª.

×¨×•×¦×” ×©××¢×©×” ×–××ª?

You said:
×œ× ×”×›×•×œ ×‘×× ×’×œ×™×ª ×¡×œ×™×—×”
ChatGPT said:
×”×‘× ×ª×™ ğŸ˜…
××ª×” ×¨×•×¦×” ×”×’×¨×¡×” ×”××œ××” ×‘×× ×’×œ×™×ª, ×›×•×œ×œ ×”×•×“×¢×•×ª, ×©××•×ª ×©×œ ××©×ª× ×™× ×•×”×¢×¨×•×ª â€“ ×‘×œ×™ ×¢×‘×¨×™×ª ×‘×›×œ×œ.

×œ×”×œ×Ÿ ×”×’×¨×¡×” ×”××¡×•×“×¨×ª, ×§×¨×™××” ×•××™×•×©×¨×ª:

pipeline {
    agent { label 'windows' }

    parameters {
        text(
            name: 'USERS',
            description: 'List of AD users (one user per line)'
        )
    }

    environment {
        OU    = 'OU=Users,DC=domain,DC=local'
        GROUP = 'GroupX'
    }

    stages {
        stage('AD User Management') {
            steps {
                withCredentials([string(credentialsId: 'AD_DEFAULT_PASSWORD', variable: 'DEFAULT_PASSWORD')]) {
                    powershell '''
Import-Module ActiveDirectory

$Users     = $env:USERS -split "`r?`n" | Where-Object { $_.Trim() -ne "" }
$OU        = $env:OU
$GroupName = $env:GROUP
$Password  = $env:DEFAULT_PASSWORD

foreach ($UserName in $Users) {

    Write-Host "=== Processing user: $UserName ==="

    $user = Get-ADUser -Filter "SamAccountName -eq '$UserName'" -ErrorAction SilentlyContinue

    if (-not $user) {
        Write-Host "User not found â€“ creating new user"

        New-ADUser `
            -Name $UserName `
            -SamAccountName $UserName `
            -AccountPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
            -Enabled $true `
            -Path $OU `
            -ChangePasswordAtLogon $true
    }
    else {
        Write-Host "âœ… User already exists"
    }

    $IsMember = Get-ADUser $UserName -Properties MemberOf |
                Select-Object -ExpandProperty MemberOf |
                Where-Object { $_ -like "*CN=$GroupName,*" }

    if (-not $IsMember) {
        Add-ADGroupMember -Identity $GroupName -Members $UserName
        Write-Host "â• User added to group $GroupName"
    }
    else {
        Write-Host "â„¹ï¸ User is already a member of the group"
    }

    Set-ADAccountPassword `
        -Identity $UserName `
        -NewPassword (ConvertTo-SecureString $Password -AsPlainText -Force) `
        -Reset

    Unlock-ADAccount -Identity $UserName
    Write-Host "ğŸ”‘ Password updated"
}
'''
                }
            }
        }
    }

    post {
        success {
            echo 'AD user management completed successfully'
            cleanWs()
        }
        failure {
            echo 'AD user management failed'
            cleanWs()
        }
    }
}
All messages, comments, and echo statements are now fully in English.

Clean, aligned, and ready for production.

Workspace is cleaned after every run.

If you want, I can also make a CSV/JSON input version with English messages, suitable for bulk AD user management. Do you want me to do that?


 


×œ× × ×‘×—×¨ ×§×•×‘×¥×œ× × ×‘×—×¨ ×§×•×‘×¥
ChatGPT can make mistakes. Check important info.
